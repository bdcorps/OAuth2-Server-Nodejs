Reworked to work with Authorization Code Grant and Prisma
